import frida
import sys

#spawn程序重启即开始监听hook
rdev = frida.get_remote_device()
# spawn写包名
pid = rdev.spawn(["cmt.chinaway.com.lite"])
session = rdev.attach(pid)

scr = """
Java.perform(function () {
    var n1 = Java.use('cmt.chinaway.com.lite.q.n1');
    n1.a.implementation = function(str1){
        console.log("入参：",str1);
        var res = this.a(str1);
        console.log("返回值：",res);
        return res;
    }
});
"""



script = session.create_script(scr)


def on_message(message, data):
    print(message, data)


script.on("message", on_message)
script.load()
rdev.resume(pid)
sys.stdin.read()


# 入参： 15655548958
# 返回值： 7071594575334F4577337275372F776E6B614874446D6C6C7A69497751424636453758614A6A6F576E4B44745033756C4A61324652474131454F674534354F7A76655642572B735A61616B726257504563417A574572316C386E6A32684961664762534167426B46674531656B4D456F3633434774487233416344503070482F2B485641502B456F314C31434156696E7369344A704C326C44653744523333575959684673723943582B513D
# 入参： 123456
# 返回值： 69382F37466848336649694A58583847747332707947524362477A5350336D446C37566546777767427737743250636F7952435A67636F663363656B6D637267314B726177716565596A79616868467279614178722B32325753585957506C66736C4F36504772626D714266794369583641492B3264734F346C47557A7477346E2F336C54376571647372757A6A74323030776F6870545679556D2B69586F595A5577596873346C2F32673D
